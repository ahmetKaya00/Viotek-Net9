@model ViotekErp.Models.StokDetayViewModel

<style>
    /* Tailwind breakpointlerinden bağımsız kesin çözüm */
    .stokdetay-cards { display: none; }  /* default: web */
    .stokdetay-table { display: block; } /* default: web */

    @@media (max-width: 640px) {
        .stokdetay-cards { display: block; }
        .stokdetay-table { display: none; }
    }
</style>

<div class="space-y-4">

    <!-- Header Özet (webde aynı, mobilde okunur) -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <!-- STOK ADI -->
        <div class="bg-slate-50 rounded-xl border border-slate-100 px-3 py-2">
            <p class="text-[11px] text-slate-500">Stok Adı</p>
            <p class="text-sm font-semibold text-slate-900 break-words">
                @Model.StokIsim
            </p>
            <p class="text-[11px] text-slate-500 mt-1">
                Kod: <span class="font-medium text-slate-700">@Model.StokKod</span>
            </p>
        </div>

        <!-- MARKA / KATEGORİ -->
        <div class="bg-slate-50 rounded-xl border border-slate-100 px-3 py-2">
            <p class="text-[11px] text-slate-500">Marka / Kategori</p>
            <p class="text-[11px] text-slate-800">
                Marka: <span class="font-semibold">@Model.MarkaKodu</span>
            </p>
            <p class="text-[11px] text-slate-800">
                Kategori: <span class="font-semibold">@Model.KategoriKodu</span>
            </p>
        </div>

        <!-- MEVCUT / SON -->
        <div class="bg-slate-50 rounded-xl border border-slate-100 px-3 py-2">
            <p class="text-[11px] text-slate-500">Mevcut / Son Hareket / Son Fiyat</p>
            <p class="text-[11px] text-slate-800">
                Mevcut: <span class="font-semibold">@Model.MevcutMiktar.ToString("N2")</span>
            </p>
            <p class="text-[11px] text-slate-800">
                Son Hareket:
                <span class="font-semibold">
                    @(Model.SonHareketTarihi?.ToString("dd.MM.yyyy") ?? "-")
                </span>
            </p>
            <p class="text-[11px] text-emerald-700">
                Son Fiyat:
                <span class="font-semibold">
                    @(Model.SonSatisFiyati.HasValue
                        ? Model.SonSatisFiyati.Value.ToString("N2") + " "
                        : "-")
                </span>
            </p>
        </div>
    </div>

    <!-- ✅ MOBİL: Hareketler kart -->
    <div class="stokdetay-cards">
        @if (Model.Hareketler != null && Model.Hareketler.Any())
        {
            <div class="flex flex-col gap-3">
                @foreach (var h in Model.Hareketler)
                {
                    <div class="rounded-2xl border border-slate-100 bg-white shadow-sm p-3">
                        <div class="flex items-start justify-between gap-3">
                            <div class="min-w-0">
                                <div class="text-[11px] text-slate-500">Tarih</div>
                                <div class="text-sm font-semibold text-slate-900">
                                    @h.Tarih?.ToString("dd.MM.yyyy HH:mm")
                                </div>

                                <div class="mt-2 text-[11px] text-slate-500">Evrak</div>
                                <div class="text-sm font-semibold text-slate-900 break-words">
                                    @h.EvrakNo
                                </div>
                            </div>

                            <div class="shrink-0 text-right">
                                <div class="text-[11px] text-slate-500">Miktar</div>
                                <div class="text-sm font-semibold text-slate-900">
                                    @(h.Miktar?.ToString("N2") ?? "-")
                                </div>

                                <div class="mt-2 text-[11px] text-slate-500">Tutar</div>
                                <div class="text-sm font-semibold text-emerald-700">
                                    @(h.Tutar?.ToString("N2") ?? "-")
                                </div>
                            </div>
                        </div>

                        <div class="mt-3 grid grid-cols-1 gap-2">
                            <div class="rounded-xl bg-slate-50 border border-slate-100 p-2">
                                <div class="text-[11px] text-slate-500">Tip</div>
                                <div class="text-xs font-semibold text-slate-900 break-words">
                                    @h.TipAciklama
                                </div>
                            </div>

                            <div class="rounded-xl bg-slate-50 border border-slate-100 p-2">
                                <div class="text-[11px] text-slate-500">Cari</div>
                                <div class="text-xs font-semibold text-slate-900 break-words">
                                    @(string.IsNullOrWhiteSpace(h.CariAd) ? h.CariKodu : h.CariAd)
                                </div>
                            </div>

                            <div class="rounded-xl bg-slate-50 border border-slate-100 p-2">
                                <div class="text-[11px] text-slate-500">Plasiyer</div>
                                <div class="text-xs font-semibold text-slate-900 break-words">
                                    @if (!string.IsNullOrWhiteSpace(h.PlasiyerAd))
                                    {
                                        <span class="font-medium">@h.PlasiyerKodu</span>
                                        <span class="mx-1 text-slate-400">-</span>
                                        <span>@h.PlasiyerAd</span>
                                    }
                                    else
                                    {
                                        @h.PlasiyerKodu
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="px-3 py-8 text-center text-slate-400 text-xs">
                Bu stok için hareket bulunamadı.
            </div>
        }
    </div>

    <!-- ✅ WEB: Hareketler tablo (webde aynı kalsın) -->
    <div class="stokdetay-table">
        <div class="border border-slate-100 rounded-xl overflow-hidden">
            <div class="overflow-x-auto">
                <table class="min-w-full text-[11px]">
                    <thead class="bg-slate-50 border-b border-slate-100">
                        <tr>
                            <th class="px-3 py-2 text-left text-slate-500 font-semibold">Tarih</th>
                            <th class="px-3 py-2 text-left text-slate-500 font-semibold">Evrak</th>
                            <th class="px-3 py-2 text-left text-slate-500 font-semibold">Tip</th>
                            <th class="px-3 py-2 text-right text-slate-500 font-semibold">Miktar</th>
                            <th class="px-3 py-2 text-right text-slate-500 font-semibold">Tutar</th>
                            <th class="px-3 py-2 text-left text-slate-500 font-semibold">Cari</th>
                            <th class="px-3 py-2 text-left text-slate-500 font-semibold">Plasiyer</th>
                        </tr>
                    </thead>

                    <tbody>
                        @if (Model.Hareketler != null && Model.Hareketler.Any())
                        {
                            foreach (var h in Model.Hareketler)
                            {
                                <tr class="border-b border-slate-50 hover:bg-slate-50/70">
                                    <td class="px-3 py-1.5 whitespace-nowrap">
                                        @h.Tarih?.ToString("dd.MM.yyyy HH:mm")
                                    </td>
                                    <td class="px-3 py-1.5 whitespace-nowrap">
                                        @h.EvrakNo
                                    </td>
                                    <td class="px-3 py-1.5 whitespace-nowrap text-slate-700">
                                        @h.TipAciklama
                                    </td>
                                    <td class="px-3 py-1.5 text-right whitespace-nowrap">
                                        @(h.Miktar?.ToString("N2") ?? "")
                                    </td>
                                    <td class="px-3 py-1.5 text-right whitespace-nowrap">
                                        @(h.Tutar?.ToString("N2") ?? "")
                                    </td>

                                    <td class="px-3 py-1.5 whitespace-nowrap text-slate-700">
                                        @(string.IsNullOrWhiteSpace(h.CariAd) ? h.CariKodu : h.CariAd)
                                    </td>

                                    <td class="px-3 py-1.5 whitespace-nowrap text-slate-700">
                                        @if (!string.IsNullOrWhiteSpace(h.PlasiyerAd))
                                        {
                                            <span class="font-medium">@h.PlasiyerKodu</span>
                                            <span class="mx-1 text-slate-400">-</span>
                                            <span>@h.PlasiyerAd</span>
                                        }
                                        else
                                        {
                                            @h.PlasiyerKodu
                                        }
                                    </td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="7" class="px-3 py-4 text-center text-slate-400">
                                    Bu stok için hareket bulunamadı.
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</div>