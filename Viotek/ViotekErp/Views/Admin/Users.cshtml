@model List<ViotekErp.Models.erp_kullanici>

@{
    Layout = "_ErpLayout";
    ViewData["Title"] = "Kullanıcı Yönetimi";
}

<div class="min-h-[calc(100vh-64px)] bg-slate-50 px-4 md:px-6 py-6">
    <div class="max-w-6xl mx-auto space-y-4">

        <div class="flex items-end justify-between">
            <div>
                <h1 class="text-2xl font-bold text-slate-900">Kullanıcı Yönetimi</h1>
                <p class="text-xs text-slate-500 mt-1">Kullanıcı ekle / çıkar / şifre güncelle.</p>
            </div>

            <a asp-action="CreateUser"
               class="rounded-xl bg-indigo-600 text-white px-4 py-2 text-sm font-semibold hover:bg-indigo-700">
                + Kullanıcı Ekle
            </a>
        </div>

        <div class="bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden">
            <div class="overflow-x-auto">
                <table class="min-w-full text-xs">
                    <thead class="bg-slate-50 border-b border-slate-100">
                        <tr>
                            <th class="px-4 py-3 text-left font-semibold text-slate-500">Kullanıcı</th>
                            <th class="px-4 py-3 text-left font-semibold text-slate-500">Ad Soyad</th>
                            <th class="px-4 py-3 text-left font-semibold text-slate-500">Rol</th>
                            <th class="px-4 py-3 text-left font-semibold text-slate-500">Sipariş Satıcı Kodu</th>
                            <th class="px-4 py-3 text-left font-semibold text-slate-500">Durum</th>
                            <th class="px-4 py-3 text-right font-semibold text-slate-500">İşlemler</th>
                        </tr>
                    </thead>

                    <tbody>
                    @foreach (var u in Model)
                    {
                        <tr class="border-b border-slate-50">
                            <td class="px-4 py-2 font-mono">@u.KullaniciAdi</td>
                            <td class="px-4 py-2">@u.AdSoyad</td>

                            <td class="px-4 py-2">
                                <span class="inline-flex rounded-full px-2 py-1 border text-[11px]
                                    @(u.Rol == "Admin"
                                        ? "bg-indigo-50 text-indigo-700 border-indigo-100"
                                        : "bg-slate-50 text-slate-700 border-slate-100")">
                                    @u.Rol
                                </span>
                            </td>

                            <td class="px-4 py-2">
                                @if (string.Equals(u.Rol, "Admin", StringComparison.OrdinalIgnoreCase))
                                {
                                    <span class="text-slate-400">-</span>
                                }
                                else
                                {
                                    <span class="font-mono text-slate-700">@(!string.IsNullOrWhiteSpace(u.SipSaticiKod) ? u.SipSaticiKod : "-")</span>
                                }
                            </td>

                            <td class="px-4 py-2">
                                <span class="inline-flex rounded-full px-2 py-1 border text-[11px]
                                    @(u.AktifMi
                                        ? "bg-emerald-50 text-emerald-700 border-emerald-100"
                                        : "bg-rose-50 text-rose-700 border-rose-100")">
                                    @(u.AktifMi ? "Aktif" : "Pasif")
                                </span>
                            </td>

                            <td class="px-4 py-2 text-right space-x-2">

                                <form asp-action="Toggle" method="post" class="inline">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="id" value="@u.Id" />
                                    <button class="px-3 py-1 rounded-lg border border-slate-200 text-[11px] hover:bg-slate-50">
                                        Aktif/Pasif
                                    </button>
                                </form>

                                <form asp-action="ChangePassword" method="post" class="inline">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="id" value="@u.Id" />
                                    <input name="newPassword" placeholder="Yeni şifre"
                                           class="w-28 px-2 py-1 rounded-lg border border-slate-200 text-[11px]" />
                                    <button class="px-3 py-1 rounded-lg bg-slate-900 text-white text-[11px] hover:bg-slate-700">
                                        Güncelle
                                    </button>
                                </form>

                                <form asp-action="Delete" method="post" class="inline">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="id" value="@u.Id" />
                                    <button class="px-3 py-1 rounded-lg bg-rose-600 text-white text-[11px] hover:bg-rose-700"
                                            onclick="return confirm('Silmek istiyor musun?');">
                                        Sil
                                    </button>
                                </form>

                            </td>
                        </tr>
                    }
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</div>